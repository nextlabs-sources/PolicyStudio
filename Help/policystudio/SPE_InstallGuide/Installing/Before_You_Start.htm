<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <title>Before_You_Start</title>

 <meta name="generator" content="Adobe RoboHelp 9" />
 <meta name="Originator" content="ImportMif" />
 <meta name="OriginalFile" content="C:\Documents and Settings\mlittle\Desktop\SharePoint\SharePointFM\Installing.fm" />
 <link rel="stylesheet" href="../../default.css" type="text/css" />

 <link rel="stylesheet" href="..\..\default.css" type="text/css" />

 <script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
p.WebHelpNavBar { text-align:right; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whtopic.js"></script>
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = document.location.href;
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = strUrl.substring(0, n);
		bc = strUrl.substring(n+3);
	}

	if (window.setRelStartPage)
	{
	addTocInfo("Installing the Entitlement Manager for SharePoint\nBefore You Start");
addButton("show",BTN_IMG,"Show TOC and Search","","","","",0,0,"../../whd_show0.gif","../../whd_show2.gif","../../whd_show1.gif");
addButton("hide",BTN_IMG,"Hide TOC and Search","","","","",0,0,"../../whd_hide0.gif","../../whd_hide2.gif","../../whd_hide1.gif");

	}

	

	if (window.setRelStartPage)
	{
	setRelStartPage("../../index.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}

}
else
	if (window.gbIE4)
		document.location.reload();
//-->
//]]></script>
</head>

<body><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(4);
//-->
//]]></script>
<table width="100%" cellspacing="0" border="1">
	<col style="width: 100%;" />
	<tr style="height: 78px;">
		<td bgcolor="#003399">&#160;</td>
	</tr>
 </table>
<script type="text/javascript" language="javascript">//<![CDATA[
document.write("<p  style=\"text-align:right;font-family:Arial;font-size:12pt;font-weight: normal;font-style: normal;text-decoration: none;\">");
AddMasterBreadcrumbs("../../index.htm", "font-family:Arial;font-size:12pt;font-weight: normal;font-style: normal;text-decoration: none;", "&gt;", "Home", "../Introducing/Welcome.htm");
document.write("<a style=\"font-family:Arial;font-size:12pt;font-weight: normal;font-style: normal;text-decoration: none;\" href=\"Installing_the_Entitlement_Manager_for_SharePoint.htm\">Installing the Entitlement Manager for SharePoint<\/a> &gt; Before You Start<\/p>");
//]]></script>
 <p style="text-align: right;">&#160;</p>

 <h1><a name="XREF_78100_Before_You_Start"></a>Before You Start</h1>
 <p class="BodyLevel1">Before you start, note the following information.</p>
 <h2>Supported Platforms</h2>
 <p class="BodyLevel1">The Entitlement Manager for Microsoft SharePoint can be installed with the following:</p>
 
<p class="BodyLevel2">1<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Microsoft Office SharePoint Server 2007 on</p>

 
<p class="BodyLevel3">1<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Windows Server 2003, Enterprise Edition, 32-bit, Service Pack 2, or</p>

 
<p class="BodyLevel3">2<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Windows Server 2008, Enterprise Edition, 64-bit, R2</p>

 
<p class="BodyLevel2">2<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Microsoft Office SharePoint Server 2010 on</p>

 
<p class="BodyLevel3">3<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Windows Server 2008, Enterprise Edition, 64-bit, R2</p>

 <h2>Installation Sequence</h2>
 <p class="BodyLevel1">Like other Compliant Enterprise&#160;Entitlement Managers, the Entitlement Manager for SharePoint&#160;consists of two parts—the Policy Controller, and the SharePoint Adapter. These are installed separately; the Policy Controller must be installed first. </p>
 <p class="PublisherBook"><span class="Emphasis">Note: </span>For any hosts running Windows 2003, .NET must be installed on them before you install the Policy Controller.</p>
 <h2><a name="XREF_83161_Installer_User"></a>Installer User Permissions</h2>
 <p class="BodyLevel1">The user who installs the Entitlement Manager for Microsoft SharePoint should have the same privileges as those Microsoft recommends for Setup User Account—that is, the user who installed SharePoint software on the server, including Administrator privileges on the machine. (More details on this may be found at <span style="color   : #0000ff; "><font color="blue" >http://technet.microsoft.com/en-us/library/cc263445.aspx</font></span>.) If a user with different permissions installs the Entitlement Manager for SharePoint, the installation may fail, or the Entitlement Manager service may encounter problems related to database access and other inter-process connections.The same user must also be used for uninstall or upgrade. </p>
 <p class="BodyLevel1">In addition, in order to install Entitlement Manager for SharePoint Server 2010, additional procedures must be followed: </p>
 
<p class="BodyLevel2">3<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Run the installer .MSI file from within a command prompt, while running the command prompt as Administrator.</p>

 
<p class="BodyLevel2">4<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Assign the installation user as the Site Collection Administrator (Primary or Secondary) for all Site Collections. </p>

 <h2><a name="XREF_16316_SharePoint_Server"></a>SharePoint Server Architecture</h2>
 <p class="BodyLevel1">There are three basic architectural scenarios for the SharePoint server. &#160;</p>
 
<p class="BodyLevel2">5<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>For a single-server architecture, where the server is running on one IIS host</p>

 
<p class="BodyLevel2">6<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>A server-farm architecture, where a single logical server is running on a number of physical hosts</p>

 
<p class="BodyLevel2">7<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>A server-farm architecture, where the search query engine is installed on the application tier</p>

 <p class="BodyLevel1">The following sections describe how installation procedures may differ depending on your implementation. </p>
 <h3>Where to Install the Entitlement Manager in a Server-Farm Architecture?</h3>
 <p class="BodyLevel1">While the sequences of installation procedures is the same for all three architectures, the locations where the Policy Controller and SharePoint Adaptor(s) must be installed differ. For a single-server architecture, you install the Entitlement Manager on the single hosting device. </p>
 <p class="BodyLevel1">For a server-farm architecture where either (a) no search result trimming will be used, or (b) SharePoint’s search query engine resides on the Web Server tier, the Policy Controller and Adaptor should be installed on all nodes in the Web Server tier. </p>
 <p class="BodyLevel1">Finally, for a server-farm architecture where search result trimming will be used, and SharePoint’s search query engine is installed on a host in the Application server tier, Policy Controller(s) and SharePoint Adaptor(s) should be installed on every physical host on the web server tier, as well as the node in the Application server tier where the search query engine resides. </p>
 <p class="PublisherBook"><span class="Emphasis">Note: </span>If FAST Search is part of the SharePoint deployment, there is currently no need to install the Entitlement Manager for SharePoint on the host were FAST Search components reside. Result trimming on FAST Search is currently not supported.</p>
 <h3>Server-Farm Configuration</h3>
 <p class="BodyLevel1">Note that there is an important configuration requirement for installing in a server-farm architecture. On a server farm, there can be multiple URLs assigned: one is the logical URL for the whole farm, others are the separate URLs of each physical machine, and some can be any other URLs. In order for the SharePoint adapter to work correctly with all the URLs, you must set the <span style="font-style : italic; "><i>logical URL of the farm</i></span>&#160;as default in the alternative URL list in the SharePoint administration interface. In addition, in order to write policies designed to cover the contents of the farm, policy designers must create a Portal Content component based on the <span style="font-style : italic; "><i>URL of the farm</i></span>, rather than on any individual host URLs.</p>
 <h3>Configuring Round-Robin DNS</h3>
 <p class="BodyLevel1">If your SharePoint server farm is configured to use a round-robin DNS to resolve the hostname in the farm’s public URL to the IP addresses of the physical hosts, you must also be sure that your DNS server has PTR (reverse lookup) entries for these IP addresses configured in it.</p>
 <p class="BodyLevel1">This is required because the Policy Server uses reverse lookups for its search feature—that is, when a Policy Studio user needs to run a SharePoint Lookup. If you do not configure your PTR entries on the DNS, this Lookup feature will not work correctly.</p>
 <h2>Firewall Requirements</h2>
 <p class="BodyLevel1">Before you begin your installation, you must define three firewall exceptions on each Entitlement Manager host. Define exceptions for the following ports:</p>
 
<p class="BodyLevel2">8<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Web Services port: 8443</p>

 
<p class="BodyLevel2">9<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span>Web Applications port: 443</p>

 
<p class="BodyLevel2">10<span style='word-spacing:normal; font:6.0pt "Times New Roman"'><font size="1" style="font-size:6pt;">&nbsp;&nbsp;&nbsp;</font></span>Push Deployment port: 2000</p>

 <p class="BodyLevel1">You do this in the Control Panel &gt;&#160;Network Settings &gt; Local Area Connection settings for each individual host, as shown below in the following figure.</p>
 <p class="BodyLevel1">These port exceptions are required to allow the Entitlement Manager to send heartbeat messages to the Control Center’s Policy Server, and receive policy bundles back from it; and also so the administrative applications can connect to the Entitlement Manager for status updates and other information.</p>
 <p class="BodyLevel1">Note that these are all default port numbers, which you may have changed in your individual installation of Control Center; if so, set the exception ports to the actual port numbers you have set. The Push Deployment port in particular is special in that it can be set differently for each Enforcer profile, in the Enforcer Profile Configuration tab in Control Center Administrator interface. (For details, see the <span style="font-style : italic; "><i>Control Center Administrator’s Guide</i></span>.)</p>
 <p class="BodyLevel1"></p>
 <div align="center"><img alt="firewall3.jpg" style="width : 487.512pt; height : 263.880pt; " id="image0" src="firewall3.jpg" />
 </div>
 <p class="BodyLevel1">&#160;</p>
 <p class="TitleBook">Adding Firewall Exception Ports</p>
 <p>&#160;</p>
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);

highlightSearch();
//-->
//]]></script>
</body>
</html>